var EMJP3={};EMJP3.Model=function(){this.word_index=0,this.word={ind:0,wordSplit:[],fgSplit:[],type:"",def:""}},EMJP3.View=function(a){var b=a,c=this;this.page_nav={show_vocab:function(){c.page_nav.transitions.slide_left(".page.homepage",".page.vocabulary"),$("footer a#new-word-btn").removeClass("hidden")},show_edit_word:function(){c.page_nav.transitions.slide_left(".page.vocabulary",".page.word-edit"),setTimeout(function(){$("#word-input").focus()},500)},transitions:{slide_left:function(a,b){$(a).addClass("off-left"),$(b).removeClass("off-right")}}},this.edit_word={edit_mode:!1,step2:function(){$("form#word-edit .form-page.page2").removeClass("hidden"),$("form#word-edit .form-page.page1").addClass("hidden");var a=b.word,d=$("#word-input").val(),e=d.split("");if(c.edit_word.edit_mode)var f=a.wordSplit==e,g=a.fgSplit.split(",");else var f=!1,g=!1;a.wordSplit=e,$("#word-input2").val(d),c.edit_word.add_fgInputs(f,g)},step3:function(){$("form#word-edit .form-page.page3").removeClass("hidden"),setTimeout(function(){$("form#word-edit .form-page.page3").addClass("fade-in")},100);var a=b.word;a.fgSplit=[];for(var d=0;d<a.wordSplit.length;d++){var e=$("#fg-input-"+d).val();a.fgSplit.push(e)}if(!c.edit_word.edit_mode){var f=b.word_index+1;$("#word-index").val(f)}$("#word-split").val(a.wordSplit),$("#fg-split").val(a.fgSplit)},add_fgInputs:function(a,c){$("#reading-input").text("");for(var d=b.word,e=0;e<d.wordSplit.length;e++){var f=document.createElement("div");f.setAttribute("id","char-input-"+e),f.setAttribute("class","char-input");var g=document.createDocumentFragment(),h=document.createElement("input");h.setAttribute("type","text"),h.setAttribute("id","fg-input-"+e),h.setAttribute("name","fg-input-"+e),h.setAttribute("class","fg-input"),a&&h.setAttribute("value",c[e]);var i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("id","kj-input-"+e),i.setAttribute("name","kj-input-"+e),i.setAttribute("class","kj-input"),i.setAttribute("value",d.wordSplit[e]),g.appendChild(h),g.appendChild(i),f.appendChild(g),$("#reading-input").append(f)}},special_reading:function(){var a=b.word,d=$("#word-input").val();a.wordSplit=[d],$("#word-input2").val(d),c.edit_word.add_fgInputs(!1,!1)}},this.popups={show:function(a){$(a).css("display","block")},hide:function(a){$(a).css("display","none")}}},EMJP3.Controller=function(a,b){var c=a,d=b,e=this;this.init_view=function(){e.word_list.bind_list_btns(),$("#edit-next-1").on("click",d.edit_word.step2),$("#edit-next-2").on("click",d.edit_word.step3),$("#spec-read").on("click",d.edit_word.special_reading),$("#edit-submit").on("click",e.edit_word.submit_new),$("a#reset-form").on("click",function(a){e.edit_word.reset_form()}),$("a#clear-words").on("click",function(a){d.popups.show("#confirm-clear-words")}),$("#confirm-clear-words #yes").on("click",function(a){e.clear_words()}),$("#confirm-clear-words #no").on("click",function(a){d.popups.hide("#confirm-clear-words")}),$("#confirm-delete-word #no").on("click",function(a){d.popups.hide("#confirm-delete-word")}),$(".homepage a#vocab-link").on("click",function(a){d.page_nav.show_vocab()}),$("footer a#new-word-btn").on("click",function(a){d.page_nav.show_edit_word()})},this.word_list={bind_list_btns:function(){for(var a=$(".edit-word-btn"),b=0;b<a.length;b++){var c=$(a[b]).attr("data-word-index"),f="input#edit-word-"+c;$(f).on("click",function(a){var b=this.getAttribute("data-word-index"),c={ind:b};e.edit_word.reset_form(),e.edit_word.set_form(c),$("#edit-submit").unbind(),$("#edit-submit").on("click",e.edit_word.submit_edit)});var g="input#del-word-"+c;$(g).on("click",function(a){var b=this.getAttribute("data-word-index");e.delete_word.to_delete=b,$("#confirm-delete-word #yes").unbind(),$("#confirm-delete-word #yes").on("click",function(a){var b=e.delete_word.to_delete,c={ind:b};e.delete_word.execute(c)}),d.popups.show("#confirm-delete-word")})}}},this.edit_word={submit_new:function(){var a=$("form#word-edit").serialize();$.ajax({method:"POST",url:"includes/submit-new.php",data:a,success:function(a){$("#vocab-list").text(""),$("#vocab-list").append(a),e.word_list.bind_list_btns(),e.edit_word.reset_form(),c.word_index+=1}})},submit_edit:function(){var a=$("form#word-edit").serialize();$.ajax({method:"POST",url:"includes/submit-edit.php",data:a,success:function(a){$("#vocab-list").text(""),$("#vocab-list").append(a),e.word_list.bind_list_btns(),e.edit_word.reset_form()}})},reset_form:function(){$("#word-edit").find("input[type=text], input[type=hidden], textarea").val(""),$("#word-display, #reading-input").text(""),$("#word-edit #title").text("New Word"),$("#edit-submit").unbind(),$("#edit-submit").on("click",e.edit_word.submit_new),d.edit_word.edit_mode=!1},set_form:function(a){$.ajax({method:"POST",url:"includes/fetch-word.php",data:a,success:function(a){var b=JSON.parse(a);$("#word-index").val(b.ind),$("#word-split").val(b.word),$("#word-input").val(b.word.split(",").join("")),$("#fg-split").val(b.reading),$("#word-type").val(b.type),$("#word-def").val(b.def),$("#word-edit #title").text("Edit Word"),c.word.ind=b.ind,c.word.wordSplit=b.word,c.word.fgSplit=b.reading,d.edit_word.edit_mode=!0}})}},this.delete_word={to_delete:0,execute:function(a){$.ajax({method:"POST",url:"includes/delete-word.php",data:a,success:function(a){$("#vocab-list").text(""),$("#vocab-list").append(a),e.word_list.bind_list_btns(),d.popups.hide("#confirm-delete-word")}})}},this.clear_words=function(){$.ajax({method:"POST",url:"includes/clear-words.php",success:function(){window.location.reload()}})}};